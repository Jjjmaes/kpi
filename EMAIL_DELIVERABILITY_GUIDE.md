# é‚®ä»¶é€è¾¾çŽ‡ä¼˜åŒ–æŒ‡å—

## ä¸ºä»€ä¹ˆé‚®ä»¶ä¼šè¿›å…¥åžƒåœ¾é‚®ç®±ï¼Ÿ

é‚®ä»¶è¿›å…¥åžƒåœ¾é‚®ç®±çš„ä¸»è¦åŽŸå› åŒ…æ‹¬ï¼š

### 1. **åŸŸåè®¤è¯ä¸å®Œæ•´**
- SPFï¼ˆSender Policy Frameworkï¼‰è®°å½•æœªé…ç½®æˆ–é…ç½®é”™è¯¯
- DKIMï¼ˆDomainKeys Identified Mailï¼‰ç­¾åæœªå¯ç”¨
- DMARCï¼ˆDomain-based Message Authenticationï¼‰ç­–ç•¥æœªè®¾ç½®

### 2. **åŸŸåå£°èª‰é—®é¢˜**
- æ–°åŸŸåæˆ–äºŒçº§åŸŸåå£°èª‰è¾ƒä½Ž
- ä¹‹å‰å‘é€è¿‡åžƒåœ¾é‚®ä»¶å¯¼è‡´åŸŸåè¢«æ ‡è®°
- å‘é€é¢‘çŽ‡è¿‡é«˜ï¼Œè§¦å‘ååžƒåœ¾é‚®ä»¶æœºåˆ¶

### 3. **é‚®ä»¶å†…å®¹é—®é¢˜**
- åŒ…å«åžƒåœ¾é‚®ä»¶å…³é”®è¯ï¼ˆå¦‚"å…è´¹"ã€"ç«‹å³"ã€"é€šçŸ¥"ç­‰ï¼‰
- HTML æ ¼å¼ä¸è§„èŒƒ
- å›¾ç‰‡è¿‡å¤šï¼Œæ–‡å­—è¿‡å°‘
- åŒ…å«å¯ç–‘é“¾æŽ¥

### 4. **å‘ä»¶äººä¿¡æ¯é—®é¢˜**
- å‘ä»¶äººé‚®ç®±åœ°å€ä¸è§„èŒƒ
- ç¼ºå°‘å›žå¤åœ°å€ï¼ˆReply-Toï¼‰
- ç¼ºå°‘é€€è®¢é“¾æŽ¥ï¼ˆList-Unsubscribeï¼‰

## è§£å†³æ–¹æ¡ˆ

### âœ… å·²å®žæ–½çš„ä¼˜åŒ–

1. **æ·»åŠ é‚®ä»¶å¤´ä¿¡æ¯**
   - `List-Unsubscribe`ï¼šé€€è®¢é“¾æŽ¥
   - `Reply-To`ï¼šå›žå¤åœ°å€
   - `X-Mailer`ï¼šé‚®ä»¶å®¢æˆ·ç«¯æ ‡è¯†
   - `X-Priority`ï¼šé‚®ä»¶ä¼˜å…ˆçº§

2. **æ·»åŠ é‚®ä»¶æ ‡ç­¾**
   - ä¾¿äºŽ Resend è¿½è¸ªå’Œåˆ†æž
   - æé«˜é‚®ä»¶åˆ†ç±»å‡†ç¡®æ€§

### ðŸ”§ éœ€è¦æ£€æŸ¥çš„é…ç½®

#### 1. **æ£€æŸ¥ Resend åŸŸåéªŒè¯çŠ¶æ€**

ç™»å½• Resend Dashboard â†’ Domains â†’ æŸ¥çœ‹ `notification.fanyiworld.com`ï¼š

- âœ… **SPF è®°å½•**ï¼šåº”è¯¥æ˜¾ç¤º `Verified`
- âœ… **DKIM è®°å½•**ï¼šåº”è¯¥æ˜¾ç¤º `Verified`
- âœ… **DMARC è®°å½•**ï¼šå»ºè®®æ·»åŠ ï¼ˆå¯é€‰ä½†æŽ¨èï¼‰

å¦‚æžœæ˜¾ç¤º `Pending` æˆ– `Failed`ï¼Œéœ€è¦ï¼š
1. ç™»å½•ä½ çš„åŸŸå DNS ç®¡ç†åŽå°
2. æ·»åŠ  Resend æä¾›çš„ DNS è®°å½•
3. ç­‰å¾… DNS ä¼ æ’­ï¼ˆé€šå¸¸å‡ åˆ†é’Ÿåˆ°å‡ å°æ—¶ï¼‰

#### 2. **æ£€æŸ¥ DNS è®°å½•**

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ£€æŸ¥ DNS è®°å½•ï¼š

```bash
# æ£€æŸ¥ SPF è®°å½•
dig TXT notification.fanyiworld.com | grep spf

# æ£€æŸ¥ DKIM è®°å½•ï¼ˆResend ä¼šæä¾›å…·ä½“çš„è®°å½•åï¼‰
dig TXT [DKIMè®°å½•å]._domainkey.notification.fanyiworld.com

# æ£€æŸ¥ DMARC è®°å½•
dig TXT _dmarc.notification.fanyiworld.com
```

#### 3. **ä¼˜åŒ–é‚®ä»¶å†…å®¹**

**é¿å…ä½¿ç”¨åžƒåœ¾é‚®ä»¶å…³é”®è¯ï¼š**
- âŒ "å…è´¹"ã€"ç«‹å³"ã€"é™æ—¶"ã€"ç‚¹å‡»è¿™é‡Œ"
- âœ… ä½¿ç”¨"é¡¹ç›®åˆ†é…"ã€"ç³»ç»Ÿé€šçŸ¥"ç­‰ä¸­æ€§è¯æ±‡

**ä¿æŒæ–‡å­—å’Œå›¾ç‰‡å¹³è¡¡ï¼š**
- æ–‡å­—å†…å®¹åº”è¯¥è¶³å¤Ÿå¤š
- é¿å…åªæœ‰å›¾ç‰‡æ²¡æœ‰æ–‡å­—

**ä½¿ç”¨è§„èŒƒçš„ HTMLï¼š**
- âœ… å·²ä½¿ç”¨æ ‡å‡†çš„ HTML ç»“æž„
- âœ… åŒ…å«çº¯æ–‡æœ¬ç‰ˆæœ¬ï¼ˆtextContentï¼‰

### ðŸ“Š ç›‘æŽ§é‚®ä»¶é€è¾¾çŽ‡

#### 1. **æŸ¥çœ‹ Resend Dashboard**

è®¿é—®ï¼šhttps://resend.com/emails

æŸ¥çœ‹ï¼š
- **å‘é€æˆåŠŸçŽ‡**ï¼šåº”è¯¥ > 95%
- **é€è¾¾çŽ‡ï¼ˆDeliveredï¼‰**ï¼šåº”è¯¥ > 90%
- **é€€ä¿¡çŽ‡ï¼ˆBouncedï¼‰**ï¼šåº”è¯¥ < 5%
- **æŠ•è¯‰çŽ‡ï¼ˆComplainedï¼‰**ï¼šåº”è¯¥ < 0.1%

#### 2. **æŸ¥çœ‹é‚®ä»¶æ—¥å¿—**

```bash
# æŸ¥çœ‹é‚®ä»¶å‘é€ç»Ÿè®¡
pm2 logs kpi --lines 500 | grep "æ‰¹é‡é‚®ä»¶å‘é€å®Œæˆ" | tail -20

# æŸ¥çœ‹å¤±è´¥è®°å½•
pm2 logs kpi --lines 500 | grep "é‚®ä»¶å‘é€å¤±è´¥" | tail -10
```

### ðŸŽ¯ æå‡é€è¾¾çŽ‡çš„å»ºè®®

#### 1. **å»ºç«‹åŸŸåå£°èª‰**

- **æ¸è¿›å¼å‘é€**ï¼šæ–°åŸŸåå¼€å§‹æ—¶å‘é€é¢‘çŽ‡ä¸è¦å¤ªé«˜
- **ä¿æŒä¸€è‡´æ€§**ï¼šä½¿ç”¨å›ºå®šçš„å‘ä»¶äººåœ°å€å’Œåç§°
- **é¿å…è¢«æ ‡è®°ä¸ºåžƒåœ¾é‚®ä»¶**ï¼šæé†’æ”¶ä»¶äººå°†å‘ä»¶äººåŠ å…¥ç™½åå•

#### 2. **ä¼˜åŒ–å‘ä»¶äººä¿¡æ¯**

å½“å‰é…ç½®ï¼š
```
RESEND_FROM_EMAIL=noreply@notification.fanyiworld.com
RESEND_FROM_NAME=è¯­å®¶TMSç³»ç»Ÿ
```

å»ºè®®ï¼š
- ä½¿ç”¨æœ‰æ„ä¹‰çš„å‘ä»¶äººåç§°ï¼ˆå¦‚"è¯­å®¶é¡¹ç›®ç®¡ç†"ï¼‰
- è€ƒè™‘ä½¿ç”¨çœŸå®žé‚®ç®±åœ°å€ï¼ˆå¦‚ `system@notification.fanyiworld.com`ï¼‰

#### 3. **æ·»åŠ  DMARC è®°å½•ï¼ˆæŽ¨èï¼‰**

åœ¨ DNS ä¸­æ·»åŠ  DMARC è®°å½•ï¼š

```
ç±»åž‹ï¼šTXT
åç§°ï¼š_dmarc
å€¼ï¼šv=DMARC1; p=none; rua=mailto:dmarc@notification.fanyiworld.com
```

è¿™ä¼šï¼š
- æé«˜é‚®ä»¶è®¤è¯å¯ä¿¡åº¦
- æä¾›é‚®ä»¶é€è¾¾æŠ¥å‘Š
- é™ä½Žè¢«æ ‡è®°ä¸ºåžƒåœ¾é‚®ä»¶çš„æ¦‚çŽ‡

#### 4. **æ”¶ä»¶äººæ“ä½œå»ºè®®**

æé†’æ”¶ä»¶äººï¼š
1. **å°†å‘ä»¶äººåŠ å…¥è”ç³»äºº**ï¼š`noreply@notification.fanyiworld.com`
2. **æ ‡è®°ä¸º"ä¸æ˜¯åžƒåœ¾é‚®ä»¶"**ï¼šå¦‚æžœé‚®ä»¶è¿›å…¥åžƒåœ¾ç®±
3. **å›žå¤é‚®ä»¶**ï¼šæé«˜å‘ä»¶äººå£°èª‰ï¼ˆå³ä½¿åªæ˜¯ç®€å•å›žå¤ï¼‰

### ðŸ” æŽ’æŸ¥æ­¥éª¤

å¦‚æžœé‚®ä»¶ä»ç„¶è¿›å…¥åžƒåœ¾ç®±ï¼š

1. **æ£€æŸ¥ Resend Dashboard**
   - æŸ¥çœ‹é‚®ä»¶çŠ¶æ€æ˜¯å¦ä¸º `Delivered`
   - æŸ¥çœ‹æ˜¯å¦æœ‰é”™è¯¯æˆ–è­¦å‘Š

2. **æ£€æŸ¥ DNS è®°å½•**
   - ç¡®è®¤ SPFã€DKIM è®°å½•å·²æ­£ç¡®é…ç½®
   - ä½¿ç”¨åœ¨çº¿å·¥å…·éªŒè¯ï¼šhttps://mxtoolbox.com/spf.aspx

3. **æµ‹è¯•é‚®ä»¶å‘é€**
   - å‘é€åˆ°ä¸åŒçš„é‚®ç®±æœåŠ¡å•†ï¼ˆGmailã€QQã€163ç­‰ï¼‰
   - æ£€æŸ¥å“ªäº›æœåŠ¡å•†ä¼šæ ‡è®°ä¸ºåžƒåœ¾é‚®ä»¶

4. **æŸ¥çœ‹é‚®ä»¶åŽŸå§‹ä¿¡æ¯**
   - åœ¨æ”¶ä»¶ç®±ä¸­æŸ¥çœ‹é‚®ä»¶åŽŸå§‹ä¿¡æ¯
   - æ£€æŸ¥ SPFã€DKIM è®¤è¯çŠ¶æ€

5. **è”ç³» Resend æ”¯æŒ**
   - å¦‚æžœé—®é¢˜æŒç»­ï¼Œè”ç³» Resend æŠ€æœ¯æ”¯æŒ
   - æä¾›é‚®ä»¶ ID å’Œè¯¦ç»†é”™è¯¯ä¿¡æ¯

### ðŸ“ æœ€ä½³å®žè·µæ€»ç»“

âœ… **å·²å®žæ–½ï¼š**
- æ·»åŠ é‚®ä»¶å¤´ä¿¡æ¯ï¼ˆList-Unsubscribeã€Reply-Toï¼‰
- ä½¿ç”¨è§„èŒƒçš„ HTML æ ¼å¼
- åŒ…å«çº¯æ–‡æœ¬ç‰ˆæœ¬
- æ·»åŠ é‚®ä»¶æ ‡ç­¾

â³ **å»ºè®®å®žæ–½ï¼š**
- æ£€æŸ¥å¹¶å®Œå–„ DNS è®°å½•ï¼ˆSPFã€DKIMã€DMARCï¼‰
- å»ºç«‹åŸŸåå£°èª‰ï¼ˆæ¸è¿›å¼å‘é€ï¼‰
- æé†’æ”¶ä»¶äººå°†å‘ä»¶äººåŠ å…¥ç™½åå•
- ç›‘æŽ§é‚®ä»¶é€è¾¾çŽ‡

---

**æç¤º**ï¼šé‚®ä»¶é€è¾¾çŽ‡æ˜¯ä¸€ä¸ªæ¸è¿›çš„è¿‡ç¨‹ï¼Œæ–°åŸŸåé€šå¸¸éœ€è¦å‡ å‘¨åˆ°å‡ ä¸ªæœˆçš„æ—¶é—´æ¥å»ºç«‹è‰¯å¥½çš„å£°èª‰ã€‚ä¿æŒä¸€è‡´çš„å‘é€å®žè·µå’Œæ­£ç¡®çš„ DNS é…ç½®æ˜¯å…³é”®ã€‚

